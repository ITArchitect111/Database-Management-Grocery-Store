INSERT INTO grocery.sales (Pur_ID, MonthlySales)
SELECT 
    p.Pur_ID,
    SUM(p.AmountPaid) OVER (PARTITION BY DATE_FORMAT(p.PurchaseDate, '%Y-%m')) AS MonthlyTotal
FROM grocery.purchase p;


SELECT * FROM grocery.sales;

SET FOREIGN_KEY_CHECKS = 0;
TRUNCATE TABLE grocery.sales;
SET FOREIGN_KEY_CHECKS = 1;
